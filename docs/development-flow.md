# 開発フロー案（個人開発向け）

## 1. フェーズ構成

1. **要件確定フェーズ**
   - ペルソナと利用シナリオの再確認（学生/社会人の共学習）。
   - マイページ、カレンダー、ランキング、タイムラインのMVP範囲を決定。
   - タスク進捗ループ（計画 → 実行 → 評価 → ランキング反映）の用語と指標を整理。

2. **アーキテクチャ設計フェーズ**
   - Next.js + Tailwind の画面構成、コンポーネント指針を検討。
   - Next.js Route Handler や Server Action の責務境界を整理する。
   - Auth.js (NextAuth) の OAuth プロバイダ構成とセッション戦略を決める。
   - レスポンシブなサイドシートナビ（モバイル）と固定サイドバー（デスクトップ）の挙動を設計。
   - PostgreSQL スキーマと Prisma の設計方針を決める。
   - ローカル開発環境（Docker Compose など）と lint/test 用スクリプト案を用意。

3. **データ契約整備フェーズ**
   - `users`, `events`, `occurrences`, `timeline_posts`, `friendships` などのテーブル定義を詳細化。
   - 繰り返し予定 (`rrule`, `exdates`)、公開範囲、可視性 enum の仕様を確定。
   - Prisma schema と API 仕様のドラフトを作成し、気づきは自分用メモに残す。

4. **バックエンド実装フェーズ**
   - 認証・ユーザー管理 → イベントCRUD → occurrence 状態更新 → ランキング集計 → タイムライン投稿の順で機能追加。
   - 機能ごとにユニット/E2E テストとエラーハンドリングを整備。
   - WebSocket/Supabase Realtime を使った即時反映の PoC を試し、必要なら拡張。

5. **フロントエンド実装フェーズ**
   - ページルーティング（`/mypage`, `/calendar`, `/ranking`, `/timeline`）を scaffold。
   - カレンダーは縦軸 = 時間のタイムブロック UI・友人切替・日付詳細表示をモックで確認。
   - デザインと UI コンポーネントを固め、カレンダー → タスク入力 → マイページ指標 → ランキング → タイムラインの順で実装。
   - API バインディングと状態管理（React Query など）を統一し、主要ユーザーフローの E2E テストを追加。

6. **統合テスト・改善フェーズ**
   - バックエンド/フロントエンドの契約テストやシナリオテストを自動化し、回帰バグを防ぐ。
   - 「1週間のタスク計画〜達成〜ランキング更新」を通しで確認し、改善アイデアをメモ。
   - リアルタイム処理の耐障害性やポイント不正対策を評価し、TODO を整理。

7. **リリース準備フェーズ**
   - Seed データでデモ環境を準備し、自分で UX をチェック。
   - Render/Vercel でのデプロイフローとロールバック手順をドキュメント化。
   - モニタリング（APM、ログ、DB メトリクス）とアラート閾値を設定し、定期確認のルーチンを決める。

## 2. 開発リズム

- 1〜2 週間を単位に進捗を振り返り、次に取り組むタスクを整理。
- 指標: 週間タスク遂行時間、ストリーク日数、ランキング整合。
- 疑問点や決定事項は適宜メモし、その都度ユーザーと確認してから進める。
- タイムライン体験のフィードバックは自身や友人テストで収集し、改善に繋げる。

## 3. 成果物と自己チェック

- 各フェーズ終了時に以下を簡易ドキュメント化して自分用チェックリストを更新：
  - 要件: ペルソナ/ユーザーストーリー/受け入れ基準。
  - 設計: アーキテクチャ図、API 仕様、DB スキーマ。
  - 実装: テスト結果、デプロイスクリプト、監視設定。
- 重要な決定や懸念点は `docs/decisions/` などにメモを残し、後から参照できるようにする。

## 4. 次のアクション（要確認）

1. Occurrence 完了処理の仕様整理（固定ポイント: DONE = +25, MISSED = -10 反映方法）。
2. 週間ランキング集計ロジックの設計メモを作成。
3. `/calendar` と `/mypage` の UI モック/期待挙動を整理し、バックエンド API の要求事項を洗い出す。
